/**
 * @fileOverview php_bs_grid is a jQuery helper plugin for php_bs_grid class. Project page https://github.com/pontikis/php_bs_grid
 * @version 0.9.1 (13 Apr 2017)
 * @licence MIT
 * @author Christos Pontikis http://www.pontikis.net
 * @copyright Christos Pontikis http://www.pontikis.net
 * @requires jquery (tested with 3.1.1), twitter bootstrap (tested with 3.3.7), jQuery UI datepicker (tested with 1.12.1)
 */
"use strict";!function(i){var t="php_bs_grid",e={init:function(e){var a=this;return this.each(function(){var _=a.data(t);if("undefined"==typeof _){var o=a.php_bs_grid("getDefaults");_=i.extend({},o,e)}else _=i.extend({},_,e);a.data(t,_);var r,d,n,c=i("#"+_.php_bs_grid_form_id),l=i("#"+_.go_top_id),p=i("#"+_.go_back_id),s=i("#"+_.go_forward_id),u=i("#"+_.go_bottom_id),v=i("#"+_.rows_per_page_id),f=i("#"+_.go_to_page_id),g=i("#"+_.page_num_id),m=i("#"+_.total_pages_id),h=i("#"+_.addnew_record_id),w=i("#"+_.columns_to_display_id),b=i("#"+_.columns_switcher_id),k=i(_.col_sortable_selector),y=i("#"+_.sort_simple_field_id),x=i("#"+_.sort_simple_order_id),I=i("#"+_.sort_advanced_id),j=i("#"+_.criteria_apply_id),S=i("#"+_.criteria_reset_id),A=i("#"+_.export_excel_id),C=i("#"+_.export_excel_btn_id),D=_.default_page_num,q=_.columns_default,O=_.columns_more,Q=_.export_excel_no,R=_.export_excel_yes,T=_.criteria_operator_text_ignore,U=_.criteria_operator_text_isnull,E=_.criteria_operator_lookup_ignore,M=_.criteria_operator_lookup_equal,P=_.criteria_operator_date_ignore,z=_.criteria_operator_date_equal,B=_.criteria_operator_date_isnull,F=_.criteria,G=function(t){var e={};return i.each(F,function(i,a){return a.criteria_name===t?(e=a,!1):void 0}),e},H=function(t){switch(t){case"text":i.each(F,function(t,e){"text"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.input_id),parseInt(d.val())===U?(r.val(""),r.hide()):(r.show(),parseInt(d.val())===T&&r.val("")))});break;case"lookup":i.each(F,function(t,e){"lookup"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.dropdown_lookup_id),parseInt(d.val())===M?r.show():r.hide())});break;case"date_start":i.each(F,function(t,e){if("date_start"===e.criteria_type){d=i("#"+e.dropdown_id),r=i("#"+e.input_id);var a=G(e.associated_criteria_name),_=i("#"+a.label_id),o=i("#"+a.dropdown_id),n=i("#"+a.input_id),c=parseInt(d.val());c===z||c===B?(_.hide(),o.val(P),o.hide(),n.val(""),n.hide(),c===B&&(r.val(""),r.hide())):(_.show(),o.show(),n.show(),r.show(),c===P&&r.val(""))}});break;case"date_end":i.each(F,function(t,e){"date_end"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.input_id),parseInt(d.val())===P&&r.val(""))})}};H("text"),H("lookup"),H("date_start"),H("date_end"),l.click(function(){J("go_top")}),p.click(function(){J("go_back")}),s.click(function(){J("go_forward")}),u.click(function(){J("go_bottom")}),v.change(function(){g.val(D),J("rows_per_page")}),f.click(function(){J("go_to_page")}),g.keypress(function(i){13===i.which&&f.click()}),h.click(function(){location.href=decodeURI(_.url_addnew_record)}),b.click(function(){parseInt(w.val())===q?w.val(O):w.val(q),J("columns_switcher")}),k.click(function(){var t=i(this).attr("id");y.val()===t?"ASC"===x.val()?x.val("DESC"):x.val("ASC"):(y.val(t),x.val("ASC")),J("sort_simple")}),I.change(function(){y.val(""),x.val(""),J("sort_advanced")}),i.each(F,function(t,e){"text"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.input_id),d.change(function(){H("text"),L()}),r.on("input",function(){L()}),r.keypress(function(i){13===i.which&&j.click()})),"lookup"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.dropdown_lookup_id),r.change(function(){L()}),d.change(function(){H("lookup"),L()})),"date_start"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.input_id),n=e.datepicker_params,n.onSelect=function(){L()},r.datepicker(n),d.change(function(){H("date_start"),L()}),r.on("input",function(){L()}),r.keypress(function(i){13===i.which&&j.click()})),"date_end"===e.criteria_type&&(d=i("#"+e.dropdown_id),r=i("#"+e.input_id),n=e.datepicker_params,n.onSelect=function(){L()},r.datepicker(n),d.change(function(){H("date_end"),L()}),r.on("input",function(){L()}),r.keypress(function(i){13===i.which&&j.click()}))}),j.click(function(){J("apply_criteria")}),S.click(function(){g.val(_.default_page_num),i.each(F,function(t,e){if("text"===e.criteria_type){var a=i("#"+e.dropdown_id),_=i("#"+e.input_id);_.val(""),a.val(T)}"lookup"===e.criteria_type&&(a=i("#"+e.dropdown_id),a.val(E)),"date_start"===e.criteria_type&&(a=i("#"+e.dropdown_id),_=i("#"+e.input_id),_.val(""),a.val(P)),"date_end"===e.criteria_type&&(a=i("#"+e.dropdown_id),_=i("#"+e.input_id),_.val(""),a.val(P))}),H("text"),H("lookup"),H("date_start"),H("date_end"),J("reset_criteria")}),C.click(function(){A.val(R),c.submit()});var J=function(t){var e=!0,a=!1,o={};i.each(F,function(t,r){if("text"===r.criteria_type){var d=i("#"+r.dropdown_id),n=i("#"+r.input_id);if(parseInt(d.val())!==U){if(n.val()&&(a=!0),o[r.input_id]=n.val(),parseInt(d.val())===T&&n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_operator,r.dropdown_id),!1;if(parseInt(d.val())!==T&&!n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_value,r.input_id),!1}}if("date_start"===r.criteria_type&&(d=i("#"+r.dropdown_id),n=i("#"+r.input_id),parseInt(d.val())!==B)){if(n.val()&&(a=!0),o[r.dropdown_id]=d.val(),o[r.input_id]=n.val(),parseInt(d.val())===P&&n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_operator,r.dropdown_id),!1;if(parseInt(d.val())!==P&&!n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_value,r.input_id),!1}if("date_end"===r.criteria_type){if(d=i("#"+r.dropdown_id),n=i("#"+r.input_id),n.val()&&(a=!0),o[r.dropdown_id]=d.val(),o[r.input_id]=n.val(),parseInt(d.val())===P&&n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_operator,r.dropdown_id),!1;if(parseInt(d.val())!==P&&!n.val())return e=!1,N(_.bs_modal_id,_.bs_modal_content_id,r.msg_missing_value,r.input_id),!1}}),e&&(a&&_.ajax_validate_form_url?i.ajax({url:decodeURI(_.ajax_validate_form_url),type:"POST",data:o,dataType:"json",success:function(i){i.error?N(_.bs_modal_id,_.bs_modal_content_id,i.error,i.focus):K(t)}}):K(t))},K=function(i){switch(i){case"go_top":g.val(D);break;case"go_back":g.val(+g.val()-1);break;case"go_forward":g.val(+g.val()+1);break;case"go_bottom":g.val(m.val());break;case"rows_per_page":g.val(D);break;case"go_to_page":}A.val(Q),c.submit()},L=function(){C.prop("disabled",!0)},N=function(t,e,a,_){var o=i("#"+t),r=i("#"+e);if(_){var d=i("#"+_);o.on("hidden.bs.modal",function(){d.focus()})}r.html(a),o.modal("show")}})},getOption:function(i){var e=this;return e.data(t)[i]},getDefaults:function(){return{php_bs_grid_form_id:"php_bs_grid_form",go_top_id:"go_top",go_back_id:"go_back",go_forward_id:"go_forward",go_bottom_id:"go_bottom",rows_per_page_id:"rows_per_page",page_num_id:"page_num",go_to_page_id:"go_to_page",total_pages_id:"total_pages",addnew_record_id:"addnew_record",columns_switcher_id:"columns_switcher",columns_to_display_id:"columns_to_display",col_sortable_class:".col-sortable",col_sortable_selector:"th.col-sortable",sort_simple_field_id:"sort_simple_field",sort_simple_order_id:"sort_simple_order",sort_advanced_id:"sort_advanced",criteria_apply_id:"criteria_apply",criteria_reset_id:"criteria_reset",export_excel_id:"export_excel",export_excel_btn_id:"export_excel_btn"}}};i.fn.php_bs_grid=function(a){return e[a]?e[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void i.error("Method "+a+" does not exist on jQuery."+t):e.init.apply(this,arguments)}}(jQuery);

